<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TillBlack — Studio</title>
    <meta name="description" content="TillBlack is a small studio crafting moody, atmospheric experiences — including Code of Shadows." />

    <!-- Social cards: these improve link previews on platforms -->
    <meta property="og:title" content="TillBlack — Studio" />
    <meta property="og:description" content="Atmospheric games & visuals. Code of Shadows by TillBlack." />
    <meta property="og:type" content="website" />

    <style>
      /* ==========================
         THEME TOKENS & GLOBALS
         ========================== */
      :root{
        --fg: #ffffff;     /* primary foreground (text) color */
        --fg-dim:#cfcfcf;  /* secondary text color */
        --bg: #0b0b0f;     /* page background behind the shader */
      }

      /* Make the viewport fill the screen and hide scrollbars on initial load */
      html,body{height:100%; margin:0; overflow:hidden;} /* Hide scrollbars */

      body{
        background:var(--bg); /* Fallback color behind WebGL canvas */
        color:var(--fg);
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, Helvetica, Arial;
        line-height:1.5;
      }

      /* The WebGL background canvas sits fixed under all content */
      #bg{position:fixed; inset:0; z-index:0;}

      /* ==========================
         LAYOUT
         ========================== */
      /*
        .wrap is the main vertical flex container.
        - justify-content:flex-start pushes content towards the top
        - padding-top controls header vertical offset (in viewport height)
        - overflow hidden on <body> prevents any scroll on first paint
      */
      .wrap{
        position:relative;
        height:100%;
        display:flex;
        flex-direction:column;
        justify-content:flex-start;   /* content hugs the top */
        align-items:center;
        padding:12vh 2rem 0;          /* top spacing = 12% viewport height; sides = 2rem */
        box-sizing:border-box;
      }

      /* Card holds hero content; keeps a max readable width */
      .card{ width:100%; max-width:1200px; border-radius:1.2rem; background:transparent; text-align:center; display:flex; flex-direction:column; gap:2rem; }

      /* Brand lockup (logo) with a subtle animated glow */
      .brand{display:grid; place-items:center; margin-top:2rem}
      .brand .logo{ 
        display:block; 
        width:clamp(140px, 16vw, 260px); /* Responsive logo width */
        height:auto; margin:0 auto; 
        filter: drop-shadow(0 0 10px rgba(255,255,255,.12));
        mix-blend-mode:difference; /* Ensure it pops over dark/light areas */
        animation: pulse-glow 5s ease-in-out infinite alternate, sway 10s ease-in-out infinite;
      }

      /* Force difference blend for all hero text to sit nicely over shader */
      .blend, .blend *{ mix-blend-mode:difference; color:white; }

      /* Typography scale using clamp for responsiveness */
      .title{font-size: clamp(36px,4vw,64px); font-weight:800; margin:0 0 .6rem}
      .sub{max-width:70ch; margin:0 auto 1.5rem; font-size:clamp(12px,1.4vw,24px)}

      /* CTA row with compact buttons */
      .cta{display:flex; gap:0.8rem; justify-content:center; flex-wrap:wrap; margin-top:1.2rem}
      .btn{ 
        padding:0.6rem 1rem; /* Button height & width */
        border-radius:0.7rem;
        border:1px solid rgba(255,255,255,.18);
        background:linear-gradient(180deg, rgba(255,255,255,.08), rgba(255,255,255,.02));
        color:white; text-decoration:none; font-weight:600;
        font-size:clamp(12px,0.9vw,15px);
        transition: transform .2s ease, box-shadow .2s ease, border-color .2s ease;
        mix-blend-mode:difference;
      }
      .btn:hover{ transform: translateY(-2px); border-color: rgba(255,255,255,.32); box-shadow:0 0 28px rgba(255,255,255,.15)}

      /* Small, tasteful motion for logo */
      @keyframes pulse-glow{ from{ filter: drop-shadow(0 0 6px rgba(255,255,255,.06)); } to{ filter: drop-shadow(0 0 18px rgba(255,255,255,.22)); } }
      @keyframes sway{ 0%{ transform: translateY(0) } 50%{ transform: translateY(-3px) } 100%{ transform: translateY(0) } }

      /* Steam widget scales down on small screens, capped on large */
      .steam-widget{margin-top:1.5rem; display:flex; justify-content:center}
      .steam-widget iframe{ width:100%; max-width:700px; height:190px; }

      /* Footer is pinned to the bottom and always visible */
      footer{position:fixed; bottom:0; left:0; right:0; text-align:center; padding:1rem; font-size:14px; mix-blend-mode:difference; color:white; background:transparent; z-index:10;}

      /* Large-screen refinements */
      @media (min-width:1800px){
        .title{font-size:72px;}
        .sub{font-size:17px;} /* NOTE: current design sets subtitle very small on huge screens */
        .btn{font-size:16px; padding:0.7rem 1.2rem;}
      }
    </style>
  </head>
  <body>
    <!-- Fullscreen WebGL background canvas (drawn by Three.js) -->
    <canvas id="bg" aria-hidden="true"></canvas>

    <main class="wrap">
      <section class="card">
        <div class="blend">
          <!-- HERO TITLE: its vertical position comes from .wrap padding/top alignment -->
          <h1 class="title">Build. Create. TillBlack.</h1>
          <!-- Subtitle text under the hero title -->
          <p id="main-text" class="sub">TillBlack is a studio blending art and technology to craft moody, timeless experiences. Our current title is <strong>Code of Shadows</strong>.</p>
          <!-- Primary calls-to-action -->
          <div class="cta">
            <a class="btn" href="https://store.steampowered.com/app/3424800/Code_of_Shadows/">→ View on Steam</a>
            <a class="btn" href="mailto:hello@tillblack.com">Contact</a>
            <a class="btn" href="#about" onclick="showAbout(event)">About</a>
          </div>
        </div>
        <!-- Optional Steam widget embed under hero copy -->
        <div class="steam-widget">
          <iframe src="https://store.steampowered.com/widget/3424800/" frameborder="0"></iframe>
        </div>
        <!-- Logo / mark -->
        <div class="brand">
          <img class="logo" src="assets/TillBlack_Logo_black.png" alt="TillBlack logo black" />
        </div>
      </section>
    </main>

    <!-- Footer copyright stays visible (position: fixed) -->
    <footer><span class="blend">© <span id="year"></span> TillBlack. All rights reserved.</span></footer>

    <!-- Three.js for WebGL rendering -->
    <script src="https://unpkg.com/three@0.160.0/build/three.min.js"></script>
    <script>
      /* ==========================
         UTILITIES
         ========================== */
      // Set current year once (no reflow issues)
      document.getElementById('year').textContent = new Date().getFullYear();

      // Cache DOM refs
      const canvas = document.getElementById('bg');
      let renderer, scene, camera, uniforms, mesh;

      /* ==========================
         THREE.JS SETUP
         ========================== */
      function init(){
        // WebGLRenderer binds to our fixed canvas. alpha:false = opaque, avoids transparency banding.
        renderer = new THREE.WebGLRenderer({ canvas, antialias:true, alpha:false });
        renderer.setPixelRatio(Math.min(devicePixelRatio, 2)); // cap devicePixelRatio for perf

        // Minimal scene + ortho camera to render a full-screen quad
        scene = new THREE.Scene();
        camera = new THREE.OrthographicCamera(-1,1,1,-1,0,1);

        // Vertex shader: passes UVs straight to the fragment stage and draws a full-screen quad
        const vertex = `
          varying vec2 vUv;
          void main(){
            vUv = uv;                    // hand UVs to fragment shader
            gl_Position = vec4(position,1.0); // already in clip space for PlaneGeometry(2,2)
          }
        `;

        // Fragment shader: builds a two-layer value-noise field and remaps it to 3 colors
        const fragment = `
          precision highp float;
          varying vec2 vUv;             // incoming texture coordinates from vertex shader
          uniform float uTime;          // time in seconds (advanced in animate())
          uniform vec2 uResolution;     // viewport resolution for aspect-correct mapping

          /* --------------------------
             Hash & value-noise helpers
             -------------------------- */
          vec2 hash(vec2 p){
            // Project p onto two skewed axes and scramble with sin/fract for pseudo-randomness
            p = vec2(dot(p, vec2(127.1,311.7)), dot(p, vec2(269.5,183.3)));
            return -1.0 + 2.0*fract(sin(p)*43758.5453123);
          }

          float noise(in vec2 p){
            // 2D simplex-like value noise (analytical gradients via hash)
            const float K1 = 0.366025404; // (sqrt(3)-1)/2
            const float K2 = 0.211324865; // (3-sqrt(3))/6
            vec2 i = floor(p + (p.x+p.y)*K1);
            vec2 a = p - i + (i.x+i.y)*K2;
            vec2 o = (a.x>a.y) ? vec2(1.0,0.0) : vec2(0.0,1.0);
            vec2 b = a - o + K2;
            vec2 c = a - 1.0 + 2.0*K2;
            vec3 h = max(0.5 - vec3(dot(a,a), dot(b,b), dot(c,c)), 0.0);
            vec3 n = h*h*h*h*vec3(
              dot(a, hash(i + 0.0)),
              dot(b, hash(i + o)),
              dot(c, hash(i + 1.0))
            );
            return dot(n, vec3(70.0)); // scale result to ~[-1,1]
          }

          void main(){
            // Aspect-corrected coordinates centered at 0
            vec2 uv = vUv;
            vec2 p = (uv - 0.5) * vec2(uResolution.x/uResolution.y, 1.0);
            float t = uTime*0.042; // global time scaling (slower = calmer)

            // Two animated noise layers traveling in different directions/frequencies
            float n1 = noise(p*1.8 + vec2(t*0.7, -t*0.5));
            float n2 = noise(p*3.2 - vec2(t*0.4,  t*0.6));
            float f  = clamp((n1 + 0.6*n2), 0.0, 1.0); // combine + normalize to [0,1]

            // Palette: black → deep blue → deep purple
            vec3 black  = vec3(0.0, 0.0, 0.0);
            vec3 blue   = vec3(0.1, 0.1, 0.3);
            vec3 purple = vec3(0.01, 0.02, 0.01); // intentionally very dark purple

            // Piecewise lerp: first half blends black→blue, second half blends blue→purple
            vec3 col;
            if(f < 0.5){
              col = mix(black, blue, smoothstep(0.0, 0.5, f));
            } else {
              col = mix(blue,  purple, smoothstep(0.5, 1.0, f));
            }

            // Vignette to center focus and hide edge artifacts
            float vign = smoothstep(0.96, 0.15, length(uv-0.5));
            col *= vign;

            gl_FragColor = vec4(col, 1.0); // opaque output (alpha disabled in renderer)
          }
        `;

        // Shader uniforms: time & resolution (pixels)
        uniforms = { uTime: { value: 0 }, uResolution: { value: new THREE.Vector2() } };

        // Fullscreen quad: PlaneGeometry(2,2) already covers NDC [-1,1]
        const geo = new THREE.PlaneGeometry(2,2);
        const mat = new THREE.ShaderMaterial({
          uniforms,
          vertexShader: vertex,
          fragmentShader: fragment,
          depthTest:false,  // draw without depth testing
          depthWrite:false, // don't write to depth buffer
          transparent:false // opaque for best color stability
        });
        mesh = new THREE.Mesh(geo, mat);
        scene.add(mesh);

        onResize();                        // set initial sizes
        window.addEventListener('resize', onResize); // keep responsive
        animate();                         // begin render loop
      }

      // Keep renderer size and uResolution in sync with the viewport
      function onResize(){
        const w = innerWidth, h = innerHeight;
        renderer.setSize(w, h, false);
        uniforms.uResolution.value.set(w, h);
      }

      // RAF loop: advance time, render scene
      function animate(t){
        uniforms.uTime.value = (t||0)*0.001; // ms → seconds
        renderer.render(scene, camera);
        requestAnimationFrame(animate);
      }

      // Init with a graceful fallback if WebGL fails
      try{ init(); }
      catch(e){
        canvas.style.display='none';
        console.warn('WebGL disabled:', e);
      }

      /* ==========================
         INTERACTIONS
         ========================== */
      // Simple content toggle for the About button
      function showAbout(e){
        e.preventDefault();
        const mainText = document.getElementById('main-text');
        if(mainText.dataset.alt === 'true'){
          mainText.innerHTML = 'TillBlack is a studio blending art and technology to craft moody, timeless experiences. Our current title is <strong>Code of Shadows</strong>.';
          mainText.dataset.alt = 'false';
        } else {
          mainText.innerHTML = 'Founded as a branch of DECOL, TillBlack aims to merge digital art and game design into unique, atmospheric projects that resonate beyond the screen.';
          mainText.dataset.alt = 'true';
        }
      }
    </script>
  </body>
</html>
